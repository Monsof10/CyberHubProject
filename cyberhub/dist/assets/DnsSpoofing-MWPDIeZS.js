import{r as i,j as e,L as r}from"./index-Cw1DFOQ-.js";import{X as a}from"./XtermTerminal-0N0nnx-D.js";import{A as t}from"./AttackPagesHeader-DyV9K30K.js";import"./GoogleTranslateLanguageSelector-pw5Yfuop.js";const m=()=>{const[n,l]=i.useState(!1),[o,s]=i.useState(!1),d=()=>{s(!0)},c=()=>{s(!1),l(!0)};return!n&&!o?e.jsxs("div",{style:{backgroundColor:"#151B3B",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(t,{pageType:"spoofing"}),e.jsx("div",{style:{flex:1,color:"#fff",padding:"40px",fontFamily:"Georgia, serif"},children:e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center"},children:[e.jsx("h1",{style:{color:"#5DADE2",fontSize:"36px",marginBottom:"30px"},children:"DNS Spoofing Attack Lab"}),e.jsxs("div",{style:{backgroundColor:"#1a2147",padding:"30px",borderRadius:"10px",marginBottom:"30px",border:"1px solid #5DADE2"},children:[e.jsx("h2",{style:{color:"#5DADE2",fontSize:"24px",marginBottom:"20px"},children:"Before You Begin"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6",marginBottom:"20px"},children:"This lab contains 3 Python script files that will guide you through understanding, detecting, and mitigating a DNS spoofing attack:"}),e.jsxs("ul",{style:{textAlign:"left",fontSize:"18px",lineHeight:"1.6",marginBottom:"30px"},children:[e.jsxs("li",{children:[e.jsx("code",{children:"dnspt1.py"})," - ",e.jsx("strong",{children:"Detection Phase:"})," Helps you identify DNS spoofing by checking DNS resolution and system configurations"]}),e.jsxs("li",{children:[e.jsx("code",{children:"dnspt2.py"})," - ",e.jsx("strong",{children:"Analysis Phase:"})," Guides you through cross-checking with trusted DNS servers and confirming the attack"]}),e.jsxs("li",{children:[e.jsx("code",{children:"dnspt3.py"})," - ",e.jsx("strong",{children:"Remediation Phase:"})," Walks you through the steps to fix the spoofed DNS settings and restore proper resolution"]})]}),e.jsx("div",{style:{backgroundColor:"#151B3B",padding:"15px",borderRadius:"5px",marginBottom:"20px"},children:e.jsxs("p",{style:{fontSize:"16px",margin:0},children:[e.jsx("strong",{style:{color:"#F1C40F"},children:"How it works:"})," These scripts will simulate a DNS spoofing attack where a malicious actor has modified your system to redirect traffic to a fake website. You'll learn how to identify the attack, analyze what happened, and fix the issue step by step."]})}),e.jsx("div",{style:{backgroundColor:"#F1C40F",color:"#000",padding:"15px",borderRadius:"5px",marginBottom:"20px"},children:"⚠️ This is a controlled environment for educational purposes only"})]}),e.jsx("button",{onClick:d,style:{backgroundColor:"#F1C40F",color:"#000",padding:"15px 30px",borderRadius:"5px",border:"none",fontSize:"20px",fontWeight:"600",cursor:"pointer"},children:"Start Lab Environment"})]})})]}):o?e.jsxs("div",{style:{backgroundColor:"#151B3B",color:"#fff",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(t,{pageType:"spoofing"}),e.jsx("div",{style:{padding:"40px",fontFamily:"Georgia, serif"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"left",maxWidth:"900px",margin:"0 auto"},children:[e.jsx("h1",{style:{color:"#5DADE2",fontSize:"36px",marginBottom:"30px",textAlign:"center"},children:"Network Architecture Explanation"}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px",width:"100%"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Overview"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6"},children:"In this DNS spoofing lab, we'll explore how attackers can manipulate DNS queries to redirect users to malicious websites. The network setup includes legitimate DNS servers, a victim's computer, and an attacker attempting to intercept and modify DNS responses."})]}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px",width:"100%"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Components"}),e.jsxs("ul",{style:{fontSize:"18px",lineHeight:"1.6",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Legitimate DNS Server:"})," The authentic DNS server that normally responds to DNS queries"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Victim's Computer:"})," The target system making DNS queries"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Attacker's System:"})," The malicious entity intercepting and modifying DNS responses"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Network Infrastructure:"})," The network components through which DNS traffic flows"]})]})]}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px",width:"100%"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Attack Flow"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6"},children:"1. The victim's computer sends a DNS query to resolve a domain name 2. The attacker intercepts this query using various techniques 3. Instead of allowing the legitimate response, the attacker sends a spoofed DNS response 4. The victim's computer receives the spoofed response and is directed to a malicious IP address"})]}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px",width:"100%"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Security Implications"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6"},children:"DNS spoofing can lead to various security issues including phishing attacks, malware distribution, and man-in-the-middle attacks. Understanding this attack helps in implementing proper DNS security measures like DNSSEC and DNS over HTTPS."})]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx("button",{onClick:c,style:{backgroundColor:"#F1C40F",color:"#000",padding:"15px 30px",borderRadius:"5px",border:"none",fontSize:"20px",fontWeight:"600",cursor:"pointer"},children:"Proceed to Lab"})})]})})]}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",minHeight:"100vh",backgroundColor:"#151B3B"},children:[e.jsx(t,{pageType:"spoofing"}),e.jsxs("div",{style:{display:"flex",flex:1,height:"calc(100vh - 100px)",overflow:"hidden"},children:[e.jsx("div",{style:{flex:1,padding:"20px",borderRight:"1px solid #5DADE2"},children:e.jsx("div",{style:{backgroundColor:"#1a2147",height:"100%",borderRadius:"5px",padding:"10px"},children:e.jsx(a,{})})}),e.jsxs("div",{style:{flex:1,padding:"20px",color:"#fff",backgroundColor:"#1a2147",borderRadius:"5px",height:"calc(100vh - 140px)",overflowY:"auto",position:"relative"},children:[e.jsx("h2",{style:{color:"#5DADE2",fontSize:"24px",marginBottom:"20px"},children:"Lab Instructions"}),e.jsxs("div",{style:{backgroundColor:"#1a2147",padding:"20px",borderRadius:"5px",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#5DADE2",fontSize:"20px",marginBottom:"15px"},children:"Step 1: Detecting DNS Spoofing"}),e.jsx("pre",{style:{backgroundColor:"#151B3B",padding:"15px",borderRadius:"5px",overflowX:"auto",marginBottom:"15px"},children:`# Navigate to the dns_spoofing directory
cd ~/dns_spoofing
# Run the detection script
python3 dnspt1.py

# Check DNS resolver configuration
cat /etc/resolv.conf

# Test domain resolution
nslookup cyberhub.com`}),e.jsxs("div",{style:{marginTop:"10px",color:"#888"},children:[e.jsx("p",{style:{marginBottom:"10px"},children:"Command explanations:"}),e.jsxs("ul",{style:{listStyleType:"none",paddingLeft:"20px"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"python3 dnspt1.py"}),": Run the detection script that performs comprehensive DNS spoofing checks"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"cat /etc/resolv.conf"}),": Display DNS resolver configuration to identify unauthorized DNS servers"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"nslookup cyberhub.com"}),": Test domain resolution to detect potential DNS hijacking"]})]})]})]}),e.jsxs("div",{style:{backgroundColor:"#1a2147",padding:"20px",borderRadius:"5px",marginBottom:"20px"},children:[e.jsx("h3",{style:{color:"#5DADE2",fontSize:"20px",marginBottom:"15px"},children:"Step 2: Analyzing DNS Resolution"}),e.jsx("pre",{style:{backgroundColor:"#151B3B",padding:"15px",borderRadius:"5px",overflowX:"auto"},children:`# Run the analysis tool
python3 dnspt2.py

# Cross-check with trusted DNS server
dig @8.8.8.8 cyberhub.com

# Check hosts file for malicious entries
grep cyberhub.com /etc/hosts`}),e.jsxs("div",{style:{marginTop:"10px",color:"#888"},children:[e.jsx("p",{style:{marginBottom:"10px"},children:"Command explanations:"}),e.jsxs("ul",{style:{listStyleType:"none",paddingLeft:"20px"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"python3 dnspt2.py"}),": Run analysis script for deeper investigation"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"dig @8.8.8.8 cyberhub.com"}),": Query trusted DNS server to verify resolution"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"grep cyberhub.com /etc/hosts"}),": Check for malicious host file entries"]})]})]})]}),e.jsxs("div",{style:{backgroundColor:"#1a2147",padding:"20px",borderRadius:"5px"},children:[e.jsx("h3",{style:{color:"#5DADE2",fontSize:"20px",marginBottom:"15px"},children:"Step 3: Fixing DNS Spoofing"}),e.jsxs("pre",{style:{backgroundColor:"#151B3B",padding:"15px",borderRadius:"5px",overflowX:"auto"},children:[`# Run the remediation script
python3 dnspt3.py

# Remove malicious entries
sudo sed -i '/cyberhub.com/d' /etc/hosts

# Verify removal
grep 'cyberhub.com' /etc/hosts || echo 'No entries found'

# Add correct DNS entry
echo '172.67.182.31 cyberhub.com' | sudo tee -a /etc/hosts

# Verify new entry
grep 'cyberhub.com' /etc/hosts

# Clear DNS cache
sudo systemd-resolve --flush-caches

# Verify DNS resolution
nslookup cyberhub.com

# Test HTTPS connection
curl -Is https://cyberhub.com | head -n 1`,"            "]}),e.jsxs("div",{style:{marginTop:"10px",color:"#888"},children:[e.jsx("p",{style:{marginBottom:"10px"},children:"Command explanations:"}),e.jsxs("ul",{style:{listStyleType:"none",paddingLeft:"20px"},children:[e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"python3 dnspt3.py"}),": Run the remediation script that guides you through the process of fixing DNS spoofing issues"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"sudo sed -i '/cyberhub.com/d' /etc/hosts"}),": Remove any existing entries for cyberhub.com from the hosts file"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"grep 'cyberhub.com' /etc/hosts || echo 'No entries found'"}),': Check if any cyberhub.com entries remain in the hosts file, displaying "No entries found" if none exist']}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"echo '172.67.182.31 cyberhub.com' | sudo tee -a /etc/hosts"}),": Add the correct IP address mapping for cyberhub.com to the hosts file"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"grep 'cyberhub.com' /etc/hosts"}),": Verify that the new legitimate entry was added correctly to the hosts file"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"sudo systemd-resolve --flush-caches"}),": Clear the system's DNS cache to ensure it starts using the new DNS settings"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"nslookup cyberhub.com"}),": Verify that the domain now resolves to the correct IP address"]}),e.jsxs("li",{style:{marginBottom:"8px"},children:[e.jsx("code",{children:"curl -Is https://cyberhub.com | head -n 1"}),": Test the HTTPS connection to verify the website is accessible and returns a valid response"]})]}),e.jsx("p",{children:"These commands help you systematically remove malicious DNS entries, add correct ones, and verify that everything is working properly."}),e.jsxs("div",{style:{backgroundColor:"#0b1437",padding:"20px",borderRadius:"5px",marginTop:"20px",color:"#F1C40F",fontSize:"18px"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"10px"},children:"Note on Attack Files"}),e.jsx("p",{children:"The files you ran are premade attack files done to show you how you can mitigate a DNS spoofing attack. Those commands represent real life scenarios. In the next levels you will learn how can you start these attacks by yourself"})]})]})]})]})]}),e.jsxs("div",{style:{padding:"20px",backgroundColor:"#1a2147",display:"flex",justifyContent:"space-between"},children:[e.jsxs(r,{to:"/Spoofing/AttackPages/CommonAttacks",style:{backgroundColor:"#5DADE2",color:"#fff",padding:"10px 20px",borderRadius:"5px",textDecoration:"none",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontSize:"20px"},children:"←"}),"Back to Common Attacks"]}),e.jsxs(r,{to:"/Spoofing/AttackPages/IpSpoofing",style:{backgroundColor:"#5DADE2",color:"#fff",padding:"10px 20px",borderRadius:"5px",textDecoration:"none",display:"flex",alignItems:"center",gap:"10px"},children:["Next: IP Spoofing Lab",e.jsx("span",{style:{fontSize:"20px"},children:"→"})]})]})]})};export{m as default};
//# sourceMappingURL=DnsSpoofing-MWPDIeZS.js.map
