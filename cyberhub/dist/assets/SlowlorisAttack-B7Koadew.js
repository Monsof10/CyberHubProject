import{r as s,A as F,u as P,j as e,L as c}from"./index-Cw1DFOQ-.js";import{S as I}from"./SimpleTerminal-DysmQor3.js";import{g as H,u as M,c as N}from"./progress-9dy4qUrl.js";import{A as d}from"./AttackPagesHeader-DyV9K30K.js";import"./GoogleTranslateLanguageSelector-pw5Yfuop.js";const G=()=>{const{user:i}=s.useContext(F),u=P(),[f,y]=s.useState(!1),[p,x]=s.useState(!1),[n,h]=s.useState(!1),[O,L]=s.useState("Ready"),[r,b]=s.useState(!1),[W,g]=s.useState(!1),[j,a]=s.useState(["[System] Monitoring system ready...","[System] Waiting for commands..."]),m=async()=>{var o;if(!(!i||!r)){g(!0);try{const t=await H(i.id),l={...t==null?void 0:t.progress,dosddos:{...(o=t==null?void 0:t.progress)==null?void 0:o.dosddos,slowlorisAttack:{completed:!0,completedAt:new Date().toISOString()}}};t?await M(i.id,l):await N(i.id,l)}catch(t){console.error("Error saving progress:",t)}finally{g(!1)}}},k=o=>{if(console.log("Command received:",o),o==="sudo python3 launch_slowloris.py"){console.log("Starting attack..."),a([]),h(!0);const t=document.querySelector("iframe");t&&(t.contentWindow.postMessage({type:"startAttack",status:"active"},"*"),localStorage.setItem("ddosAttackStatus","active"))}else if(o==="sudo iptables -A INPUT -p tcp --syn --dport 4000 -m connlimit --connlimit-above 20 -j DROP"){console.log("Stopping attack..."),h(!1),a(["[System] Attack stopped.","[System] Waiting for commands..."]);const t=document.querySelector("iframe");t&&(t.contentWindow.postMessage({type:"stopAttack",status:"stopped"},"*"),localStorage.setItem("ddosAttackStatus","stopped")),b(!0),m()}};s.useEffect(()=>{if(!i){u("/login");return}let o;return n&&(o=setInterval(()=>{const t=new Date,l=t.getHours().toString().padStart(2,"0"),D=t.getMinutes().toString().padStart(2,"0"),C=t.getSeconds().toString().padStart(2,"0"),A=t.getMilliseconds().toString().padStart(3,"0"),T=`${l}:${D}:${C}.${A}`,B=Math.floor(3e4+Math.random()*3e4),E=Math.floor(Math.random()*4294967295),R=`${T} IP 127.0.0.1.${B} > 127.0.0.2.4000: Flags [S], seq ${E}, win 65495, options [mss 65495,sackOK,TS val ${Math.floor(Math.random()*4294967295)} ecr 0,nop,wscale 7], length 0`;a(z=>[...z,R])},50)),()=>{o&&clearInterval(o)}},[n]);const S=()=>{x(!0)},v=()=>{x(!1),y(!0)},w=`
    <!DOCTYPE html>
    <html>
    <head>
        <title>This site can't be reached</title>
        <style>
            body {
                font-family: -apple-system, system-ui, sans-serif;
                padding: 40px;
                color: #202124;
            }
            .error-icon {
                font-size: 48px;
                margin-bottom: 20px;
            }
            .title {
                font-size: 20px;
                font-weight: 500;
                margin-bottom: 8px;
            }
            .subtitle {
                color: #5f6368;
                margin-bottom: 20px;
            }
            .try-list {
                color: #5f6368;
                padding-left: 20px;
            }
            .try-list li {
                margin: 8px 0;
            }
            .error-code {
                color: #5f6368;
                margin-top: 20px;
                margin-bottom: 20px;
            }
            .btn {
                padding: 8px 16px;
                border-radius: 4px;
                font-size: 14px;
                cursor: pointer;
            }
            .reload {
                background: #1a73e8;
                color: white;
                border: none;
                margin-right: 12px;
            }
            .details {
                background: white;
                color: #1a73e8;
                border: 1px solid #dadce0;
            }
        </style>
    </head>
    <body>
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="title">This site can't be reached</div>
        <div class="subtitle">blairhotels.com took too long to respond.</div>
        
        <div>Try:</div>
        <ul class="try-list">
            <li>Checking the connection</li>
            <li>Checking the proxy and the firewall</li>
            <li>Running Windows Network Diagnostics</li>
        </ul>

        <div class="error-code">ERR_CONNECTION_TIMED_OUT</div>

        <button class="btn reload">Reload</button>
        <button class="btn details">Details</button>
    </body>
    </html>
  `;return p?e.jsxs("div",{style:{backgroundColor:"#151B3B",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(d,{pageType:"dos"}),e.jsx("div",{style:{padding:"40px",fontFamily:"Georgia, serif",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center"},children:e.jsxs("div",{style:{maxWidth:"900px",width:"100%"},children:[e.jsx("h1",{style:{color:"#5DADE2",fontSize:"36px",marginBottom:"30px",textAlign:"center"},children:"Network Architecture Explanation"}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Overview"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6"},children:"Slowloris is a low-bandwidth DDoS attack that works by keeping many HTTP connections open for as long as possible. Unlike traditional DDoS attacks that flood servers with traffic, Slowloris achieves denial of service by slowly and partially completing HTTP requests."})]}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Components"}),e.jsxs("ul",{style:{fontSize:"18px",lineHeight:"1.6",paddingLeft:"20px"},children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Web Server:"})," The target system with limited connection pool."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Connection Pool:"})," Server's capacity to handle concurrent connections."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"HTTP Headers:"})," Partial headers sent to keep connections alive."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Connection Timeout:"})," Server's wait time for complete requests."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Attacker Client:"})," System maintaining multiple incomplete connections."]})]})]}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Attack Flow"}),e.jsxs("p",{style:{fontSize:"18px",lineHeight:"1.6"},children:["1. Attacker opens multiple connections to the target server.",e.jsx("br",{}),"2. Each connection sends partial HTTP headers periodically.",e.jsx("br",{}),"3. Server keeps connections open waiting for completion.",e.jsx("br",{}),"4. Connection pool becomes exhausted with incomplete requests.",e.jsx("br",{}),"5. Legitimate users cannot establish new connections."]})]}),e.jsxs("section",{style:{marginBottom:"20px",backgroundColor:"#0b1437",padding:"20px",borderRadius:"8px"},children:[e.jsx("h2",{style:{color:"#F1C40F",fontSize:"28px",marginBottom:"10px"},children:"Why It Matters"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6"},children:"Understanding Slowloris architecture is crucial because it's particularly effective against Apache and similar servers. The attack requires minimal bandwidth and appears legitimate in logs. Proper implementation of connection timeouts, rate limiting, and reverse proxy configurations are essential countermeasures."})]}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx("button",{onClick:v,style:{backgroundColor:"#F1C40F",color:"#000",padding:"15px 30px",borderRadius:"5px",border:"none",fontSize:"20px",fontWeight:"600",cursor:"pointer"},children:"Proceed to Lab"})})]})})]}):!f&&!p?e.jsxs("div",{style:{backgroundColor:"#151B3B",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(d,{pageType:"dos"}),e.jsx("div",{style:{padding:"40px",fontFamily:"Georgia, serif",color:"#fff"},children:e.jsxs("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center"},children:[e.jsx("h1",{style:{color:"#5DADE2",fontSize:"36px",marginBottom:"30px"},children:"Slowloris Attack Lab"}),e.jsxs("div",{style:{backgroundColor:"#1a2147",padding:"30px",borderRadius:"10px",marginBottom:"30px",border:"1px solid #5DADE2"},children:[e.jsx("h2",{style:{color:"#5DADE2",fontSize:"24px",marginBottom:"20px"},children:"Before You Begin"}),e.jsx("p",{style:{fontSize:"18px",lineHeight:"1.6",marginBottom:"20px"},children:"In this lab, you will:"}),e.jsxs("ul",{style:{textAlign:"left",fontSize:"18px",lineHeight:"1.6",marginBottom:"30px"},children:[e.jsx("li",{children:"Learn about Slowloris attacks and their impact on web servers"}),e.jsx("li",{children:"Understand how Slowloris keeps connections open indefinitely"}),e.jsx("li",{children:"Monitor server resource exhaustion"}),e.jsx("li",{children:"Implement mitigation strategies against Slowloris attacks"})]}),e.jsx("div",{style:{backgroundColor:"#F1C40F",color:"#000",padding:"15px",borderRadius:"5px",marginBottom:"20px"},children:"‚ö†Ô∏è This is a controlled environment for educational purposes only"})]}),e.jsx("button",{onClick:S,style:{backgroundColor:"#F1C40F",color:"#000",padding:"15px 30px",borderRadius:"5px",border:"none",fontSize:"20px",fontWeight:"600",cursor:"pointer"},children:"Start Lab Environment"})]})})]}):e.jsxs("div",{style:{backgroundColor:"#151B3B",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[e.jsx(d,{pageType:"dos"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"1fr 1fr",gap:"20px",padding:"20px",flex:1,overflowY:"auto"},children:[e.jsxs("div",{style:{backgroundColor:"#1a2147",borderRadius:"5px",padding:"20px",color:"#fff",display:"flex",flexDirection:"column",maxHeight:"calc(50vh - 60px)",overflowY:"auto"},children:[e.jsx("h3",{style:{color:"#5DADE2",marginBottom:"15px",flexShrink:0},children:"Attack Terminal"}),e.jsx("div",{style:{flexGrow:1,minHeight:"300px"},children:e.jsx(I,{onCommand:k})})]}),e.jsxs("div",{style:{backgroundColor:"#1a2147",borderRadius:"5px",padding:"20px",color:"#fff",maxHeight:"calc(50vh - 60px)",overflowY:"auto"},children:[e.jsx("h3",{style:{color:"#5DADE2",marginBottom:"15px"},children:"Instructions"}),e.jsxs("div",{style:{backgroundColor:"#151B3B",padding:"15px",borderRadius:"5px",marginBottom:"15px"},children:[e.jsx("h4",{style:{color:"#F1C40F",marginBottom:"10px"},children:"Step 1: Launch the Attack"}),e.jsx("p",{children:"1. In the Attack Terminal, type and run:"}),e.jsx("pre",{style:{backgroundColor:"#000",padding:"10px",borderRadius:"5px",marginTop:"10px",color:"#5DADE2"},children:"sudo python3 launch_slowloris.py"}),e.jsxs("p",{style:{marginTop:"10px"},children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"sudo"})," ‚Äì Runs the command with superuser (admin) privileges."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"python3"})," ‚Äì Invokes the Python 3 interpreter to run a Python script."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"launch_slowloris.py"})," ‚Äì The Python script that initiates a Slowloris attack by keeping many connections open indefinitely."]}),e.jsx("p",{style:{marginTop:"10px"},children:"2. Watch the Monitoring Terminal to see the attack progress and then click on the link again , DON'T refresh the old website because the attack is being fetched , we are using a local storage in the backend to organise events for the website , no need to confuse yourself , just click the link after and before running commands and you will understand"}),e.jsx("p",{style:{marginTop:"10px"},children:"3. The target website should become unresponsive"})]}),e.jsxs("div",{style:{backgroundColor:"#151B3B",padding:"15px",borderRadius:"5px"},children:[e.jsx("h4",{style:{color:"#F1C40F",marginBottom:"10px"},children:"Step 2: Stop the Attack"}),e.jsx("p",{children:"1. Once the website is unresponsive, type and run:"}),e.jsx("pre",{style:{backgroundColor:"#000",padding:"10px",borderRadius:"5px",marginTop:"10px",color:"#5DADE2"},children:"sudo iptables -A INPUT -p tcp --syn --dport 4000 -m connlimit --connlimit-above 20 -j DROP"}),e.jsxs("p",{style:{marginTop:"10px"},children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"sudo"})," ‚Äì Runs the command with superuser (admin) privileges."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"iptables"})," ‚Äì The command-line utility to set up, maintain, and inspect Linux firewall rules."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"-A INPUT"})," ‚Äì Appends (-A) a rule to the INPUT chain (which handles incoming traffic)."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"-p tcp --syn"})," ‚Äì Matches TCP SYN packets (new connection attempts)."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"--dport 4000"})," ‚Äì Specifies port 4000 as the destination port, which is where the Slowloris attack is targeting."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"-m connlimit --connlimit-above 20"})," ‚Äì Limits connections to port 4000 to 20 per source IP, preventing the Slowloris attack from keeping too many connections open."]}),e.jsxs("p",{children:["‚Ä¢ ",e.jsx("span",{style:{color:"#40E0D0"},children:"-j DROP"})," ‚Äì Tells iptables to drop any matching packets (ignore and do not respond)."]}),e.jsx("p",{style:{marginTop:"10px"},children:"2. Watch the Monitoring Terminal - traffic should normalize"}),e.jsx("p",{style:{marginTop:"10px"},children:"3. The target website should become responsive again"}),e.jsxs("div",{style:{backgroundColor:"#0b1437",padding:"20px",borderRadius:"5px",marginTop:"20px",color:"#F1C40F",fontSize:"18px"},children:[e.jsx("h3",{style:{marginTop:0,marginBottom:"10px"},children:"Note on Attack Files"}),e.jsx("p",{children:"The files you ran are premade attack files done to show you how you can mitigate a Slowloris attack. Those commands represent real life scenarios. In the next levels you will learn how can you start these attacks by yourself"})]})]})]}),e.jsxs("div",{style:{backgroundColor:"#1a2147",borderRadius:"5px",padding:"20px",color:"#fff",maxHeight:"calc(50vh - 60px)",display:"flex",flexDirection:"column"},children:[e.jsx("h3",{style:{color:"#5DADE2",marginBottom:"15px",flexShrink:0},children:"Monitoring Terminal"}),e.jsx("div",{style:{flexGrow:1,backgroundColor:"#000",borderRadius:"5px",padding:"10px",overflowY:"auto",minHeight:"200px"},children:j.map((o,t)=>e.jsx("div",{style:{color:o.includes("normalizing")||o.includes("<100ms")?"#44ff44":"#ff4444",marginBottom:"5px",fontFamily:"monospace",fontSize:"14px"},children:o},t))})]}),e.jsxs("div",{style:{backgroundColor:"#151B3B",borderRadius:"10px",padding:"20px",color:"#fff"},children:[e.jsx("h2",{style:{color:"#5DADE2",marginBottom:"20px",fontSize:"28px",fontWeight:"normal"},children:"Target Website"}),e.jsxs("div",{style:{backgroundColor:"#1a2147",padding:"20px",borderRadius:"10px",display:"flex",flexDirection:"column",gap:"15px"},children:[e.jsx("div",{style:{backgroundColor:"#151B3B",padding:"10px",borderRadius:"5px",marginBottom:"10px"},children:e.jsx("div",{onClick:()=>{n?window.open("","_blank").document.write(w):window.open("https://blairhotels.com","_blank")},style:{color:"#5DADE2",textDecoration:"none",display:"block",textAlign:"center",cursor:"pointer"},children:"https://blairhotels.com"})}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"Status:"}),e.jsx("span",{style:{color:n?"#ff4444":"#44ff44",fontSize:"16px"},children:n?"Offline":"Online"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"Response Time:"}),e.jsx("span",{style:{color:n?"#ff4444":"#5DADE2",fontSize:"16px"},children:n?`>${Math.floor(2e3+Math.random()*1e3)}ms`:"<100ms"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontSize:"16px"},children:"Traffic:"}),e.jsx("span",{style:{color:n?"#ff4444":"#5DADE2",fontSize:"16px"},children:n?`${Math.floor(1e4+Math.random()*5e3)} req/s`:"Normal"})]})]})]})]}),e.jsxs("div",{style:{padding:"20px",backgroundColor:"#1a2147",display:"flex",justifyContent:"space-between",zIndex:10},children:[e.jsxs("div",{style:{display:"flex",gap:"10px"},children:[e.jsxs(c,{to:"/",style:{backgroundColor:"#5DADE2",color:"#fff",padding:"10px 20px",borderRadius:"5px",textDecoration:"none",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontSize:"20px"},children:"üè†"}),"Home"]}),e.jsxs(c,{to:"/DosAndDdos/AttackPages/DdosAttack",style:{backgroundColor:"#5DADE2",color:"#fff",padding:"10px 20px",borderRadius:"5px",textDecoration:"none",display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("span",{style:{fontSize:"20px"},children:"‚Üê"}),"Previous: DDoS Attack"]})]}),e.jsxs(c,{to:"/DosAndDdos/AttackPages/HttpFloodAttack",style:{backgroundColor:r?"#F1C40F":"#5DADE2",color:r?"#000":"#fff",padding:"10px 20px",borderRadius:"5px",textDecoration:"none",display:"flex",alignItems:"center",gap:"10px"},onClick:m,children:[r?"Continue to HTTP Flood Attack":"Next: HTTP Flood Attack",e.jsx("span",{style:{fontSize:"20px"},children:"‚Üí"})]})]})]})};export{G as default};
//# sourceMappingURL=SlowlorisAttack-B7Koadew.js.map
